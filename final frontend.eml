import React, { useState } from "react";
import background from "./img.jpg";
import logo from "./swe.jpg";
import "./App.css";

const FakeInstagramAccountDetection = () => {
  const [formData, setFormData] = useState({
    username: "",
    fullName: "",
    profile_pic: false,
    bio: "",
    external_url: false,
    is_private: false,
    num_posts: 0,
    num_followers: 0,
    num_following: 0,
  });

  const [result, setResult] = useState(null); // State for the prediction
result
  const [loading, setLoading] = useState(false); // State for loading
spinner

  // Handle input changes for form data
  const handleChange = (e) => {
    const { name, type, checked, value } = e.target;
    setFormData((prevData) => ({
      ...prevData,
      [name]: type === "checkbox" ? checked : (type === "number" ? parseInt(
value, 10) || 0 : value),
    }));
  };

  // Handle form submission and make API call to backend
  const handleSubmit = (e) => {
    e.preventDefault();
    console.log("Submitting Data:", formData);  // Log the form data before
sending to the backend

    setLoading(true); // Show loading spinner while waiting for the response

    // Make POST request to the backend
    fetch("http://localhost:5000/predict", {  // Make sure to use the
correct URL
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(formData),  // Send form data to the backend
    })
      .then((response) => response.json())  // Parse the JSON response from
the backend
      .then((data) => {
        console.log("Prediction Result:", data);  // Log the prediction
result for debugging
        setResult(data);  // Update the result state with the prediction
data
        setLoading(false);  // Hide loading spinner when done
      })
      .catch((error) => {
        console.error("Prediction Error:", error);  // Log any error from
the fetch request
        setLoading(false);  // Hide loading spinner if there's an error
      });
  };

  return (
    <div
      style={{
        minHeight: "100vh",
        backgroundImage: `url(${background})`,
        backgroundSize: "cover",
        backgroundPosition: "center",
        padding: "50px 20px",
      }}
    >
      <div
        style={{
          maxWidth: "500px",
          margin: "0 auto",
          padding: "30px",
          backgroundColor: "rgb(244, 230, 238)",
          border: "1px solid #ccc",
          borderRadius: "12px",
          boxShadow: "0 2px 8px rgba(240, 224, 224, 0.2)",
          fontFamily: "Arial, sans-serif",
        }}
      >
        <div style={{ textAlign: "center", marginBottom: "20px" }}>
          <img src={logo} alt="App Logo" style={{ width: "120px", height:
"auto" }} />
        </div>
        <h2 style={{ textAlign: "center", marginBottom: "20px" }} className=
"detector">
          Fake Instagram Account Detection!
        </h2>

        <form onSubmit={handleSubmit} className="form-container">
          {/* Username, Full Name */}
          {[{ label: "Username", name: "username", type: "text" },
            { label: "Full Name", name: "fullName", type: "text" }]
            .map(({ label, name, type }) => (
              <div key={name} style={{ marginBottom: "15px" }}>
                <label htmlFor={name} style={{ display: "block",
marginBottom: "5px" }}>
                  {label}
                </label>
                <input
                  type={type}
                  id={name}
                  name={name}
                  value={formData[name]}
                  onChange={handleChange}
                  required
                  style={{
                    width: "100%",
                    padding: "8px",
                    borderRadius: "5px",
                    border: "1px solid #ccc",
                    backgroundColor: "rgba(82,168,192,0.24)",
                  }}
                />
              </div>
            ))}

          {/* Bio */}
          <div style={{ marginBottom: "15px" }}>
            <label htmlFor="bio" style={{ display: "block", marginBottom:
"5px" }}>
              Bio
            </label>
            <textarea
              id="bio"
              name="bio"
              value={formData.bio}
              onChange={handleChange}
              rows="3"
              style={{
                width: "100%",
                padding: "8px",
                borderRadius: "5px",
                border: "1px solid #ccc",
                backgroundColor: "rgba(82,168,192,0.24)",
              }}
            />
          </div>

          {/* Checkboxes */}
          {[{ label: "Has Profile Picture", name: "profile_pic" },
            { label: "Has External Link", name: "external_url" },
            { label: "Private Account", name: "is_private" }]
            .map(({ label, name }) => (
              <div key={name} style={{ marginBottom: "10px" }}>
                <label>
                  <input
                    type="checkbox"
                    name={name}
                    checked={formData[name]}
                    onChange={handleChange}
                    style={{ marginRight: "8px" }}
                  />
                  {label}
                </label>
              </div>
            ))}

          {/* Posts, Followers, Following */}
          {[{ label: "Number of Posts", name: "num_posts", type: "number" },
            { label: "Number of Followers", name: "num_followers", type:
"number" },
            { label: "Number of Followings", name: "num_following", type:
"number" }]
            .map(({ label, name, type }) => (
              <div key={name} style={{ marginBottom: "15px" }}>
                <label htmlFor={name} style={{ display: "block",
marginBottom: "5px" }}>
                  {label}
                </label>
                <input
                  type={type}
                  id={name}
                  name={name}
                  value={formData[name]}
                  onChange={handleChange}
                  required
                  style={{
                    width: "100%",
                    padding: "8px",
                    borderRadius: "5px",
                    border: "1px solid #ccc",
                    backgroundColor: "rgba(82,168,192,0.24)",
                  }}
                />
              </div>
            ))}

          <button
            type="submit"
            style={{
              marginTop: "20px",
              width: "100%",
              padding: "10px",
              backgroundColor: "#007BFF",
              color: "#fff",
              border: "none",
              borderRadius: "6px",
              cursor: "pointer",
              fontSize: "16px",
            }}
          >
            Detect Account
          </button>
        </form>

        {/* Display Prediction Result */}
        {loading && (
          <div style={{ marginTop: "20px", textAlign: "center" }}>
            <p>Loading...</p>
          </div>
        )}

        {result && !loading && (
          <div style={{ marginTop: "20px", textAlign: "center" }}>
            <h3>Prediction Result</h3>
            <p><strong>Best Model:</strong> {result.best_model_used}</p>
            <p><strong>Confidence Score:</strong> {result.confidence_score}
</p>
            <p><strong>Account Status:</strong> {result.prediction === "Fake
Account" ? "Fake Account" : "Genuine Account"}</p>
          </div>
        )}
      </div>
    </div>
  );
};

export default FakeInstagramAccountDetection;










